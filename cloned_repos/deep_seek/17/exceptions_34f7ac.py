import io
import json
import re
from typing import TYPE_CHECKING, Any, Dict, List, Mapping, Optional, Union, TypeVar, Set, Tuple, Sequence
from dbt.node_types import REFABLE_NODE_TYPES, AccessType, NodeType
from dbt_common.constants import SECRET_ENV_PREFIX
from dbt_common.dataclass_schema import ValidationError
from dbt_common.exceptions import CommandResultError, CompilationError, DbtConfigError, DbtInternalError, DbtRuntimeError, DbtValidationError, env_secrets, scrub_secrets

if TYPE_CHECKING:
    import agate
    from dbt.contracts.graph.nodes import ManifestNode, ParsedNode
    from dbt.contracts.graph.unparsed import UnparsedNode
    from dbt.contracts.results import NodeResult
    from dbt.contracts.files import FilePath
    from dbt.contracts.graph.manifest import Manifest
    from dbt.contracts.relation import Relation
    from dbt.adapters.base.relation import BaseRelation
    from dbt.contracts.graph.model_config import NodeConfig
    from dbt.contracts.graph.parsed import ParsedSourceDefinition
    from dbt.contracts.graph.compiled import CompiledNode
    from dbt.contracts.graph.patched import PatchedNode
    from dbt.contracts.graph.parsed import ParsedMacro
    from dbt.contracts.graph.manifest import MacroManifest
    from dbt.contracts.graph.parsed import ParsedTestNode
    from dbt.contracts.graph.parsed import ParsedModelNode
    from dbt.contracts.graph.parsed import ParsedSeedNode
    from dbt.contracts.graph.parsed import ParsedSnapshotNode
    from dbt.contracts.graph.parsed import ParsedAnalysisNode
    from dbt.contracts.graph.parsed import ParsedHookNode
    from dbt.contracts.graph.parsed import ParsedRPCNode
    from dbt.contracts.graph.parsed import ParsedDocumentationNode
    from dbt.contracts.graph.parsed import ParsedExposureNode
    from dbt.contracts.graph.parsed import ParsedMetricNode
    from dbt.contracts.graph.parsed import ParsedGroupNode
    from dbt.contracts.graph.parsed import ParsedVersionedNode
    from dbt.contracts.graph.manifest import ManifestStateCheck
    from dbt.contracts.graph.manifest import ManifestLoader
    from dbt.contracts.graph.manifest import ManifestValidator
    from dbt.contracts.graph.manifest import ManifestUpdater
    from dbt.contracts.graph.manifest import ManifestSearcher
    from dbt.contracts.graph.manifest import ManifestDiffer
    from dbt.contracts.graph.manifest import ManifestBuilder
    from dbt.contracts.graph.manifest import ManifestContext
    from dbt.contracts.graph.manifest import ManifestMetadata
    from dbt.contracts.graph.manifest import ManifestWritable
    from dbt.contracts.graph.manifest import ManifestReadable
    from dbt.contracts.graph.manifest import ManifestState
    from dbt.contracts.graph.manifest import ManifestChange
    from dbt.contracts.graph.manifest import ManifestChangeSet
    from dbt.contracts.graph.manifest import ManifestChangeResult
    from dbt.contracts.graph.manifest import ManifestChangeError
    from dbt.contracts.graph.manifest import ManifestChangeWarning
    from dbt.contracts.graph.manifest import ManifestChangeInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiff
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffSet
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffResult
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffError
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffWarning
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffInfo
    from dbt.contracts.graph.manifest import ManifestChangeDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItemDiffItem
   